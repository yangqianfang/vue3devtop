var F=(E,f,p)=>new Promise((b,c)=>{var g=t=>{try{_(p.next(t))}catch(d){c(d)}},B=t=>{try{_(p.throw(t))}catch(d){c(d)}},_=t=>t.done?b(t.value):Promise.resolve(t.value).then(g,B);_((p=p.apply(E,f)).next())});import{d as P,f as z,r as h,u as M,b as I,a3 as T,z as G,j as s,o as D,h as C,a as u,w as n,aE as H,aB as J,i as K,l as U,m as Q,n as W,aa as X,ad as Y,x as Z,q as ee,s as ue,aN as ae,aO as ne,A as le,c as se,a9 as te}from"./index.2818b27f.js";import{a as oe,s as ie}from"./userlist.b35dc308.js";import{p as re}from"./publicData.40242d81.js";import"./console.fe19ffe3.js";const pe={style:{"margin-left":"80px"}},ce=U(" \u4FDD\u5B58 "),_e=U(" \u53D6\u6D88 "),Fe=P({name:"add",setup(E){const f=re(),p=z(),b=h(""),c=h(!1),g=h(null),B=M(),_=h([]),t=window.$Loading,d=[{label:"\u8D85\u7EA7\u7BA1\u7406\u5458",value:"1"},{label:"\u666E\u901A\u7528\u6237",value:"2"}],L=[{label:"\u542F\u7528",value:"1"},{label:"\u7981\u7528",value:"0"}],A={username:{required:!0,message:"\u8BF7\u8F93\u5165\u767B\u5F55\u540D\u79F0",trigger:["blur","input"]},nickname:{required:!0,message:"\u8BF7\u8F93\u5165\u771F\u5B9E\u59D3\u540D",trigger:["blur","input"]},password:{message:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801",trigger:["blur","input"]},appmembers:{required:!0,message:"\u8BF7\u8F93\u5165\u9879\u76EE\u6210\u5458",trigger:["blur","input"]},publish:{type:"array",required:!0,message:"\u8BF7\u8F93\u52FE\u9009\u53EF\u53D1\u5E03\u9879\u76EE",trigger:["change"]}};let a=I((()=>({username:"",nickname:"",password:"",cid:"1",enable:"1",publish:[]}))());const w=T(()=>f.publicData);G(()=>F(this,null,function*(){const{id:r}=p.currentRoute.value.params;!w.value&&(yield f.getPublicData()),_.value=w.value.enables,r&&(b.value=r,R(r))}));function R(r){return F(this,null,function*(){try{t.value.show();const e=yield oe({id:r}),{user:o}=e,i=o.publish;console.log("publish\u63A5\u6536"),console.log(i);let m=i.split("@");console.log("publish\u89E3\u6790\u540E"),console.log(m),i==="all"&&(m=_.value);const v={id:o.id,username:o.username,nickname:o.nickname,password:"",cid:String(o.cid),enable:String(o.enable),publish:m};a=Object.assign(s(a),v),t.value.hide()}catch(e){t.value.hide()}})}function V(){g.value.validate(r=>F(this,null,function*(){if(!r){const e=Object.assign({},a);e.publish=e.publish.join("@"),c.value=!0;try{yield ie(e),c.value=!1,e.id?B.success("\u4FDD\u5B58\u6210\u529F\uFF01"):y()}catch(o){c.value=!1}}}))}function y(){p.push({name:"user-list"})}return(r,e)=>{const o=Q,i=W,m=te,v=X,$=Y,k=Z,x=ee,q=ue,j=ae,N=ne,S=le;return D(),C("div",null,[u(S,{bordered:!1,class:"mt-4 proCard","content-style":"padding-top: 0;padding-bottom: 0;",size:"small",title:b.value?"\u7F16\u8F91\u7528\u6237":"\u6DFB\u52A0\u7528\u6237"},{default:n(()=>[u(N,{cols:"1 s:1 m:3 l:3 xl:3 2xl:3",responsive:"screen"},{default:n(()=>[u(j,{offset:"0 s:0 m:1 l:1 xl:1 2xl:1"},{default:n(()=>[u(q,{"label-width":120,model:s(a),rules:A,"label-placement":"left",ref_key:"formRef",ref:g,class:"py-8"},{default:n(()=>[u(i,{label:"\u767B\u5F55\u540D\u79F0",path:"username"},{default:n(()=>[u(o,{placeholder:"\u8F93\u5165\u767B\u5F55\u540D\u79F0",value:s(a).username,"onUpdate:value":e[0]||(e[0]=l=>s(a).username=l)},null,8,["value"])]),_:1}),u(i,{label:"\u771F\u5B9E\u59D3\u540D",path:"nickname"},{default:n(()=>[u(o,{placeholder:"\u8F93\u5165\u771F\u5B9E\u59D3\u540D",value:s(a).nickname,"onUpdate:value":e[1]||(e[1]=l=>s(a).nickname=l)},null,8,["value"])]),_:1}),u(i,{label:"\u7528\u6237\u5BC6\u7801",path:"password"},{default:n(()=>[u(o,{autocomplete:"",placeholder:"\u8F93\u5165\u7528\u6237\u5BC6\u7801",type:"password","show-password-on":"click",value:s(a).password,"onUpdate:value":e[2]||(e[2]=l=>s(a).password=l)},null,8,["value"])]),_:1}),u(i,{label:"\u53EF\u53D1\u5E03\u9879\u76EE",path:"publish"},{default:n(()=>[u($,{value:s(a).publish,"onUpdate:value":e[3]||(e[3]=l=>s(a).publish=l)},{default:n(()=>[u(v,{"item-style":"display: flex;"},{default:n(()=>[(D(!0),C(H,null,J(_.value,(l,O)=>(D(),se(m,{value:l,label:l,key:O},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),u(i,{label:"\u7528\u6237\u6743\u9650",path:"cid"},{default:n(()=>[u(k,{placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u6743\u9650",options:d,value:s(a).cid,"onUpdate:value":e[4]||(e[4]=l=>s(a).cid=l)},null,8,["value"])]),_:1}),u(i,{label:"\u7528\u6237\u72B6\u6001",path:"enable"},{default:n(()=>[u(k,{placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u72B6\u6001",options:L,value:s(a).enable,"onUpdate:value":e[5]||(e[5]=l=>s(a).enable=l)},null,8,["value"])]),_:1}),K("div",pe,[u(v,null,{default:n(()=>[u(x,{type:"primary",onClick:V,loading:c.value},{default:n(()=>[ce]),_:1},8,["loading"]),u(x,{type:"default",onClick:y},{default:n(()=>[_e]),_:1})]),_:1})])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1},8,["title"])])}}});export{Fe as default};
